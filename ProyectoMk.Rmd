---
title: "ProyectoMk"
output: html_document
---

Karina Ibarra 136608, Daniela OrdoÃ±ez 136977, Andres Albores 131749

#IntroducciÃƒÂ³n

###Violencia intrafamiliar (plantamiento del problema)

Violencia intrafamiliar es un tipo de abuso que puede incluir violencia fisica, violencia sexual, amenazas de violencia o abuso emocional. Su origen es debatido por muchos aunque se cree que las principales causas son falta de recursos econÃƒÂ³micos, el abuso del alcohol y la drogadicciÃƒÂ³n, asociados comÃƒÂºnmente con  la pobreza.

Fuente:
http://www.violenciaenlafamilia.conapo.gob.mx/en/Violencia_Familiar/Violencia_en_la_Familia

### Base de datos utilizada y descripcion de datos

Los datos en los que nos basamos para nuestra investigaciÃƒÂ³n se obtuvieron de la DirecciÃƒÂ³n General de Epidemiologia de la Secretaria de Salud durante el perido de 2003 a 2014

La informaciÃƒÂ³n esta dividida en:

  -Casos reportados por fuentes: muestra el nÃƒÂºmero total de victimas por entidad federativa, reportado por las principales instituciones de salud.

  -Casos por grupo de Edad: Presenta el nÃƒÂºmero total de victimas por entidad federativa, reportado para los grupos de edad establecidos.

  -Casos de ocurrencia por mes: Presenta el nÃƒÂºmero total de victimas, por entidad federativa, reportado por mes.

Asimismo, para cada uno de estos tres grandes grupos la informaciÃƒÂ³n se divide en tres categorias segÃƒÂºn gÃƒÂ©nero: Femenino, Masculino y ambos.

**Nota:** Las categorias utilizadas para cada uno de los tres grandes grupos se presentan en el diccionario adjunto. 

### Del Presente Documento
En este documento se presenta una anÃƒÂ¡lisis de los casos presentados de violencia domestica,durante el periodo 2003-2014, basado en los datos registrados por la DirecciÃƒÂ³n General de EpidemiologÃƒ­a de la Secretaria de Salud. En  este se presenta, en una primera parte los problemas que se plantean para ser resueltos mediante el anÃƒÂ¡lisis; posteriormente se describe cÃƒÂ³mo es que se han obtenido los datos y con quÃƒÂ© medios se ha realizado la obtenciÃƒÂ³n de los mismas,asimismo, se realiza una breve descripciÃƒÂ³n de los datos y con base a esta se define el alcance y lÃƒ­mite de los datos; ulteriormente se transforman los datos obtenidos a formatos que permitan una mejor manipulaciÃƒÂ³n de los mismos y faciliten su analisis; en seguida se realizan pruebas de calidad sobre los datos de transformados;procedemos despuÃƒÂ©s a realizar el anÃƒÂ¡lisis exploratorio de los datos con el objetivo de resolver los problemas que se plantearon en un inicio y , finalmente, se se presentan las conclusiones para el trabajo realizado.

#DefiniciÃƒÂ³n del Problema

En el presente documento nos proponemos identificar cuÃƒÂ¡les son las ÃƒÂ©pocas en que se debe prestar mayor atenciÃƒÂ³n al fenÃƒÂ³meno, cuÃƒÂ¡l es la tendencia del fenÃƒÂ³meno, cuÃƒÂ¡les son las instituciones que atienden un mayor nÃƒÂºmero de casos, quÃƒÂ© entidades y quÃƒÂ© grupos de edad y quÃƒÂ© sexo son mÃƒÂ¡s vulnerables al fenÃƒÂ³meno para mejorar el apoyo que se brinda a las vÃƒ­ctimas y las acciones preventivas que se toman en cada estado.

#ObtenciÃƒÂ³n de datos

http://www.epidemiologia.salud.gob.mx/anuario/html/anuarios.html

### De los Recursos Utilizados

Los datos empleados para el anÃƒÂ¡lisis fueron obtenidos de la pagina http://www.epidemiologia.salud.gob.mx/anuario/html/anuarios.html, la informaciÃƒÂ³n fue obtenida en formato pdf y transformada mediante el programa "Tabula" a formato csv para facilitar el anÃƒÂ¡lisis (para mayor informaciÃƒÂ³n sobre el programa visite http://tabula.technology/). El anÃƒÂ¡lisis de los datos se realizÃƒÂ³ en "RStudio", la informaciÃƒÂ³n tÃƒÂ©cnica de este ÃƒÂºltimo se presenta a continuaciÃƒÂ³n:


```{r Directorio}
directorio <- "C:/Users/Andres/OneDrive/Tenth Semester/EstadÃ­stica Aplicada I/GitHub/EA1"
setwd(directorio)
knitr::opts_knit$set(root.dir = directorio)
```

```{r Informacion Session, echo=FALSE}
sessionInfo()
```

## Realizamos la lectura de los datos

```{r LecturaValores, echo=FALSE}

library(plyr)
###FUENTE
violencia.fuente <- NULL 
titulos.fuente <- NULL
for (i in 1:12){ 
violencia.fuente[[i]] <- read.csv(paste("./Datos/BrutosCSV/Fuente/FuenteFem",i+2002,".csv",  sep = "" ), stringsAsFactors = FALSE)
titulos.fuente[i] <- paste("FuenteFem",i+2002,sep="")
}

for (i in 1:12){
violencia.fuente[[i]] <- read.csv(paste("./Datos/BrutosCSV/Fuente/FuenteGen",i+2002,".csv",sep=""),stringsAsFactors=FALSE)
titulos.fuente[i] <- paste("FuenteGen",i+2002,sep="")
}

for (i in 1:12){
violencia.fuente[[i]] <- read.csv(paste("./Datos/BrutosCSV/Fuente/FuenteMasc",i+2002,".csv",sep=""),stringsAsFactors=FALSE)
titulos.fuente[i] <- paste("FuenteMasc",i+2002,sep="")
}
names(violencia.fuente) <- titulos.fuente

###EDAD
violencia.edad <- NULL
titulos.edad <- NULL
for (i in 1:12){
violencia.edad[[i]] <- read.csv(paste("./Datos/BrutosCSV/Grupo/GrupoFem",i+2002,".csv",sep=""),stringsAsFactors=FALSE)
titulos.edad[i] <- paste("GrupoFem",i+2002,sep="")
}

for (i in 1:12){
violencia.edad[[i]] <- read.csv(paste("./Datos/BrutosCSV/Grupo/GrupoGen",i+2002,".csv",sep=""),stringsAsFactors=FALSE)
titulos.edad[i] <- paste("GrupoGen",i+2002,sep="")
}

for (i in 1:12){
violencia.edad[[i]] <- read.csv(paste("./Datos/BrutosCSV/Grupo/GrupoMasc",i+2002,".csv",sep=""),stringsAsFactors=FALSE)
titulos.edad[i] <- paste("GrupoMasc",i+2002,sep="")
}
names(violencia.edad) <- titulos.edad

###MES
violencia.mes <- NULL 
titulos.mes <- NULL
for (i in 1:12){ 
violencia.mes[[i]] <- read.csv(paste("./Datos/BrutosCSV/Mes/MesFem",i+2002,".csv",  sep = "" ), stringsAsFactors = FALSE)
titulos.mes[i] <- paste("GrupoFem",i+2002,sep="")
  }

for (i in 1:12){
violencia.mes[[i]] <- read.csv(paste("./Datos/BrutosCSV/Mes/MesGen",i+2002,".csv",sep=""),stringsAsFactors=FALSE)
titulos.mes[i] <- paste("GrupoGen",i+2002,sep="")
}

for (i in 1:12){
violencia.mes[[i]] <- read.csv(paste("./Datos/BrutosCSV/Mes/MesMasc",i+2002,".csv",sep=""),stringsAsFactors=FALSE)
titulos.mes[i] <- paste("GrupoMasc",i+2002,sep="")
}
names(violencia.mes) <- titulos.mes
```

## Limpieza de datos

```{r Edicion}
##FUENTE
for (i in 1:33){ 
names(violencia.fuente[[i]]) <-toupper(names(violencia.fuente[[i]]))
}

for (i in 1:33){ 
names(violencia.fuente[[i]]) <-gsub("SEDEMAR","SEMAR",names(violencia.fuente[[i]]))
}

for (i in 1:33){ 
names(violencia.fuente[[i]]) <-gsub("SALUD","SSA",names(violencia.fuente[[i]]))
}

##EDAD
for (i in 1:33){ 
names(violencia.edad[[i]]) <- c("Estado","Menor a 1","1 a 4","5 a 9", "10 a 14","15 a 19", "20 a 24","25 a 44", "45 a 49","50 a 59","60 a 64","65 o Mas","Desconocida")
}
for (i in 1:33){ 
names(violencia.edad[[i]]) <-toupper(names(violencia.edad[[i]]))
}

##MES
for (i in 1:33){ 
names(violencia.mes[[i]]) <-toupper(names(violencia.mes[[i]]))
}
```

##Guardamos la informacion en 3 grupos de DATA.

````{r SaveData}
##FUENTE
violencia.intrafamiliar.fuente <- ldply(violencia.fuente,data.frame)
save(violencia.intrafamiliar.fuente, file="violencia_intrafamiliar_Fuente.RData")

##EDAD
violencia.intrafamiliar.edad <- ldply(violencia.edad,data.frame)
save(violencia.intrafamiliar.edad, file="violencia_intrafamiliar_Edad.RData")

##MES
violencia.intrafamiliar.mes <- ldply(violencia.mes,data.frame)
save(violencia.intrafamiliar.mes, file="violencia_intrafamiliar_Mes.RData")
```

##Se consolido la informacion en 3 grupos: violencia.intrafamiliar.fuente, violencia.intrafamiliar.grupo, violencia.intrafamiliar.mes. A continuacion se presenta un extracto de cada uno de ellos:

*Reporte de casos de violencia  por Fuente/Institucion*
```{r, echo=FALSE}
head(violencia.intrafamiliar.fuente)
```

*Reporte de casos de violencia  por Grupo de Edad*
```{r, echo=FALSE}
head(violencia.intrafamiliar.edad)
```

*Reporte de casos de violencia  por Mes*
```{r, echo=FALSE}
head(violencia.intrafamiliar.mes)
```


##Se presenta la estructura de los archivos consolidados y las variables de cada uno.

*Reporte de casos de violencia  por Fuente/Institucion*
```{r, echo=FALSE}
str(violencia.intrafamiliar.fuente)
```

*Reporte de casos de violencia  por Grupo de Edad*
```{r, echo=FALSE}
str(violencia.intrafamiliar.edad)
```

*Reporte de casos de violencia  por Mes*
```{r, echo=FALSE}
str(violencia.intrafamiliar.mes)
```

##Limpieza de los datos despues de la carga

##Se introducen dos nuevas variables: Sexo y Periodo.
##Se elimina la variable .id en cada DATA.
```{r Sexo y Periodo}
##FUENTE
violencia.intrafamiliar.fuente$PERIODO <- factor(substr(violencia.intrafamiliar.fuente$.id,5,8), ordered=TRUE)
violencia.intrafamiliar.fuente$SEXO <- factor(substr(violencia.intrafamiliar.fuente$.id,3,3))
violencia.intrafamiliar.fuente$.id <- NULL
violencia.intrafamiliar.fuente <- within(violencia.intrafamiliar.fuente,{
  SEXO <- gsub("m","Masculino",SEXO,fixed=TRUE)
  SEXO <- gsub("f","Femenino",SEXO,fixed=TRUE)
  SEXO <- gsub("g","General",SEXO,fixed=TRUE)
 })

save(violencia.intrafamiliar.fuente, file="violencia_intrafamiliar_Fuente(Sexo-Periodo).RData")

##EDAD
violencia.intrafamiliar.edad$PERIODO <- factor(substr(violencia.intrafamiliar.edad$.id,5,8), ordered=TRUE)
violencia.intrafamiliar.edad$SEXO <- factor(substr(violencia.intrafamiliar.edad$.id,3,3))
violencia.intrafamiliar.edad$.id <- NULL
violencia.intrafamiliar.edad <- within(violencia.intrafamiliar.edad,{
  SEXO <- gsub("m","Masculino",SEXO,fixed=TRUE)
  SEXO <- gsub("f","Femenino",SEXO,fixed=TRUE)
  SEXO <- gsub("g","General",SEXO,fixed=TRUE)
 })

save(violencia.intrafamiliar.edad, file="violencia_intrafamiliar_Edad(Sexo-Periodo).RData")

##MES
violencia.intrafamiliar.mes$PERIODO <- factor(substr(violencia.intrafamiliar.mes$.id,5,8), ordered=TRUE)
violencia.intrafamiliar.mes$SEXO <- factor(substr(violencia.intrafamiliar.mes$.id,3,3))
violencia.intrafamiliar.mes$.id <- NULL
violencia.intrafamiliar.mes <- within(violencia.intrafamiliar.mes,{
  SEXO <- gsub("m","Masculino",SEXO,fixed=TRUE)
  SEXO <- gsub("f","Femenino",SEXO,fixed=TRUE)
  SEXO <- gsub("g","General",SEXO,fixed=TRUE)
 })

save(violencia.intrafamiliar.mes, file="violencia_intrafamiliar_Mes(Sexo-Periodo).RData")
```

##Convertimos las variables a tipo nominal
```{r Variable Nominal, echo=FALSE}

#FUENTE
violencia.intrafamiliar.fuente$ESTADO <- factor(violencia.intrafamiliar.fuente$ESTADO)
violencia.intrafamiliar.fuente$SEXO <- factor(violencia.intrafamiliar.fuente$SEXO)

save(violencia.intrafamiliar.fuente,file="violencia_Fuente_Limp.RData")

#EDAD
violencia.intrafamiliar.edad$ESTADO <- factor(violencia.intrafamiliar.edad$ESTADO)
violencia.intrafamiliar.edad$SEXO <- factor(violencia.intrafamiliar.edad$SEXO)

save(violencia.intrafamiliar.edad,file="violencia_Edad_Limp.RData")


#MES
violencia.intrafamiliar.mes$ESTADO <- factor(violencia.intrafamiliar.mes$ESTADO)
violencia.intrafamiliar.mes$SEXO <- factor(violencia.intrafamiliar.mes$SEXO)

save(violencia.intrafamiliar.mes,file="violencia_Mes_Limp.RData")

```

